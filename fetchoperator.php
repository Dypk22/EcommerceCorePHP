<?php require 'connection.php'; $mobile=$_POST['number']; $checkNumber=mysqli_num_rows(mysqli_query($con, "select * from mobile_recharge_orders where mobile='$mobile' order by id desc limit 1")); $getDetails=mysqli_fetch_assoc(mysqli_query($con, "select * from mobile_recharge_orders where mobile='$mobile' order by id desc limit 1")); $operator_type=''; if($checkNumber>0){$operator=$getDetails['operator']; $location=$getDetails['operator_circle']; $operator_type=$getDetails['operator_type'];}else{$url='http://apilayer.net/api/validate?access_key=9a136fa9f73708907ebc14b6d4774303&number=91'.$mobile; $ch=curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE); curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE); $data=curl_exec($ch); $httpstatus=curl_getinfo($ch, CURLINFO_HTTP_CODE); curl_close($ch); /*// echo "Errors: ".curl_error($ch)."<br>"; if any // echo "Status: ".$httpstatus."<br>"; Status Code*/$res=json_decode($data); $operator=strtolower($res->carrier); $location=strtolower($res->location);}if($operator=='reliance communications ltd (rcom)' || $operator=='aircel cellular ltd' || $operator=='mahanagar telephone nigam ltd (mtnl)' || $operator=='videocon telecom'){$operator='vodafone idea ltd (formerly idea cellular ltd)';}if($operator=='vodafone idea ltd (formerly vodafone india ltd)'){$operator='vodafone idea ltd (formerly idea cellular ltd)';}$_SESSION['selected_operator']=strtolower($operator); $data=array('carrier'=> strtolower($operator), 'location'=> strtolower($location), 'operator_type'=> $operator_type); header('Content-Type: application/json; charset=utf-8'); echo json_encode($data); ?>